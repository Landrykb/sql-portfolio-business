# Business SQL Analytics Portfolio

## About
SQL data analysis projects completed through the **BleepxQuery SwiftLink Training Program**.
Domain: **Business** | Challenges Solved: **7/9** | Completion: **78%**

## Skills Demonstrated
- SQL (SELECT, JOIN, GROUP BY, Window Functions, CTEs, Subqueries)
- Data Analysis & Aggregation
- Real-world problem solving with industry datasets

## Projects

### 1. Basics Select



```sql
-- TODO: write query for basics_select
SELECT * FROM business_retail
  WHERE  business_retail.branch = "A"
  ORDER BY  business_retail.gross_income DESC
  LIMIT 5;
```

### 2. Agg Revenue
- **Attempts:** 4


```sql
SELECT product_line, SUM(total) AS total_revenue
FROM business_retail
GROUP BY product_line
ORDER BY total_revenue DESC;
```

### 3. Joins Returns
- **Attempts:** 4


```sql
SELECT b.invoice_id, b.total, r.return_reason
FROM business_retail b
LEFT JOIN returns r ON b.invoice_id = r.invoice_id
WHERE r.return_reason IS NOT NULL
ORDER BY b.total DESC
LIMIT 5;
```

### 4. Window Cumsum
- **Attempts:** 4


```sql
SELECT branch, date, total,
 SUM(total) OVER (PARTITION BY branch ORDER BY date) AS cumulative_sales
FROM business_retail
ORDER BY branch, date;
```

### 5. Cte Profit
- **Attempts:** 4


```sql
WITH ReturnTotals AS (
 SELECT b.branch, SUM(b.total) AS return_total
 FROM business_retail b
 JOIN returns r ON b.invoice_id = r.invoice_id
 GROUP BY b.branch
)
SELECT b.branch, SUM(b.total) - COALESCE(r.return_total, 0) AS net_profit
FROM business_retail b
LEFT JOIN ReturnTotals r ON b.branch = r.branch
GROUP BY b.branch
ORDER BY net_profit DESC;
```

### 6. Capstone Root
- **Attempts:** 4


```sql
WITH Sales AS (
  SELECT
    branch,
    product_line,
    SUM(total)          AS total_sales
  FROM business_retail
  GROUP BY branch, product_line
),
ReturnCounts AS (
  SELECT
    b.branch,
    b.product_line,
    COUNT(*)            AS return_count
  FROM returns r
  INNER JOIN business_retail b
    ON r.invoice_id = b.invoice_id
  GROUP BY b.branch, b.product_line
)
SELECT
  s.branch,
  s.product_line,
  s.total_sales,
  COALESCE(rc.return_count, 0) AS return_count
FROM Sales s
LEFT JOIN ReturnCounts rc
  ON s.branch       = rc.branch
AND s.product_line = rc.product_line
ORDER BY s.total_sales DESC;
```

### 7. Hidden Sales Boost
- **Attempts:** 4


```sql
WITH BranchProduct AS (
  SELECT
    branch,
    product_line,
    SUM(total) AS total_revenue,
    ROUND(AVG(rating), 2) AS avg_rating,
    COUNT(*) AS transaction_count
  FROM business_retail
  GROUP BY branch, product_line
)
SELECT
  branch,
  product_line,
  total_revenue,
  avg_rating,
  transaction_count,
  CASE
    WHEN total_revenue > 18000 AND avg_rating < 7.0 THEN 'High Priority'
    WHEN total_revenue > 15000 AND avg_rating < 7.0 THEN 'Medium Priority'
    ELSE 'Monitor'
  END AS growth_opportunity
FROM BranchProduct
ORDER BY total_revenue DESC;
```

## How to Run
1. Load the CSV datasets into any SQL database (SQLite, PostgreSQL, etc.)
2. Run each query against the loaded tables
3. See `queries/` folder for individual .sql files

## Datasets
- **business_retail** — 1000 rows, 17 columns (invoice_id, branch, city, customer_type, gender...)
- **returns** — 500 rows, 3 columns (invoice_id, return_date, return_reason)

---
*Generated by [BleepxQuery](https://bleepxacademy.vercel.app) — SwiftLink Training Program*
